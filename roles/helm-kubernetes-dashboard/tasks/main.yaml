---

#######################################
# Install Kubernetes Dashboard via Helm
#######################################

- name: Adding Kubernetes Dashboard via Helm
  shell: |
    helm install --atomic --dep-up \
    --name kube-system \
    --namespace kube-system \
    --set service.type=LoadBalancer \
    --set service.externalPort=80 \
    --set service.internalPort=9090 \
    --set service.loadBalancerSourceRanges="{ {{ dashboard_access_cidr | join(',') }} }" \
    --set enableInsecureLogin=true \
    --set ingress.enabled=true \
    stable/kubernetes-dashboard

- name: Add a Dashboard Admin user account
  shell: |
    kubectl apply -f {{ role_path }}/files/{{item}}.yaml
  with_items:
    - ServiceAccount
    - ClusterRoleBinding

